    <!--breadcrumb-->
    <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-5">
        <div class="breadcrumb-title pe-3">CAPE </div>
        <div class="ps-3">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0 p-0">
              <li class="breadcrumb-item"><a routerLink="/admin/dashboard"><i class="bx bx-home-alt"></i></a>
              </li>
              <li class="breadcrumb-item active" aria-current="page">Liste des demandes d'autorisation</li>
            </ol>
          </nav>
        </div>
      </div>
  
      <div class="row">
        <div class="col-lg-12">
            <div class="card">
              
                <div class="mb-3">
                    <button *ngIf="state!=undefined" (click)="goToShow()" class="btn btn-sm btn-primary mx-1">Consulter</button>
                    <button  *ngIf="role == 'dfea' "   (click)="delete()" class="btn btn-sm btn-danger mx-1">Retirer l'enregistrement</button>
                    <button *ngIf="state==undefined" (click)="add(parcoursContent)" class="btn btn-sm btn-primary mx-1">Voir Parcours</button>
                </div>
                <div class="card-body">
    
                            <p>{{data.length}} élément(s) </p>
                         <ng-container *ngIf="type=='cape'">
                            <div class="table-responsive">
                                <table class="table" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
                                    <thead class="">
                                        <tr>
                                            <th style="width: 10px;"> # </th>
                                            <th style="width: 10px;"><i class="fa fa-check"></i></th>
                                            <th>Date d'inscription</th>
                                            <th *ngIf="role != 'cps'">Cps</th>
                                            <th>Type Centre</th>
                                            <th>Libellé Centre</th>
                                            <th *ngIf="state != undefined">Statut</th>
                                            <th *ngIf="state == undefined">Dernière étape</th>
                                            <th>Nom promoteur</th>
                                            <th>Cible</th>
                                            <th>Adresse</th>
                                            <th>email</th>
                                            <th>phone</th>
                                
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let d of data ">
                                            <td></td>
                                            <td>
                                                <div class="form-check mb-2">
                                                    <input (click)="checked(d)" class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                                                
                                                </div>
                                            </td>
                                            <td>{{d.created_at | date:"shortDate"}}</td>
                                            <td *ngIf="role != 'cps'">{{d.district?.cps?.name}}</td>
                                            <td>{{d.type_cape?.name ?? d.type_garderie?.name }}</td>
                                            <td>{{d.name}}</td>
                                            <td  *ngIf="state !=undefined">
                                                <span class="p-1 rounded bg-{{getColor(d.status)}} text-white">{{getText(d.status)}} </span>
                                            </td>
                                            <td *ngIf="state ==undefined">
                                                {{d.last_parcours?.libelle}}
                                            </td>
                                            <td>{{d.name_pomoter}} {{d.firstname_pomoter}}</td>
                                            <td>
                                                <ul>
                                                    <li *ngFor="let el of getJson(d.target)">{{el}}</li>
                                                </ul>
                                            </td>
                                            <td>{{d.address}}</td>
                                            <td>{{d.email}}</td>
                                            <td>{{d.phone}}</td>
                                        
                                            
                                        </tr>
                                    
                                    </tbody>
                                </table>
                                </div>
                         </ng-container>
                         <ng-container *ngIf="type=='garderie'">
                            <div class="table-responsive">
                                <table class="table" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
                                    <thead class="">
                                        <tr>
                                            <th style="width: 10px;"> # </th>
                                            <th style="width: 10px;"><i class="fa fa-check"></i></th>
                                            <th>Date d'inscription</th>
                                            <th *ngIf="role != 'cps'">Cps</th>
                                            <th>Type Garderie</th>
                                            <th>Libellé Centre</th>
                                            <th *ngIf="state != undefined">Statut</th>
                                            <th *ngIf="state == undefined">Dernière étape</th>
                                            <th>Nom promoteur</th>
                                            <th>Adresse</th>
                                            <th>email</th>
                                            <th>phone</th>
                                
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let d of data ">
                                            <td></td>
                                            <td>
                                                <div class="form-check mb-2">
                                                    <input (click)="checked(d)" class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                                                
                                                </div>
                                            </td>
                                            <td>{{d.created_at | date:"shortDate"}}</td>
                                            <td *ngIf="role != 'cps'">{{d.district?.cps?.name}}</td>
                                            <td>
                                                <ul>
                                                    <li *ngFor="let el of d.requete_type_garderies">{{el.type_garderie?.name}}</li>
                                                </ul>
                                            </td>
                                            <td>{{d.name}}</td>
                                            <td  *ngIf="state !=undefined">
                                                <span class="p-1 rounded bg-{{getColor(d.status)}} text-white">{{getText(d.status)}} </span>
                                            </td>
                                            <td *ngIf="state ==undefined">
                                                {{d.last_parcours?.libelle}}
                                            </td>
                                            <td>{{d.name_pomoter}} {{d.firstname_pomoter}}</td>
                                            
                                            <td>{{d.address}}</td>
                                            <td>{{d.email}}</td>
                                            <td>{{d.phone}}</td>
                                        
                                            
                                        </tr>
                                    
                                    </tbody>
                                </table>
                                </div>
                         </ng-container>
    
                </div><!-- end card -->
            </div>
            <!-- end col -->
        </div>
        <!-- end col -->
    </div>
    

    <ng-template #parcoursContent let-c="close" let-d="dismiss">
    
        <div class="modal-header bg-secondary">
          <h6 class="text-white">Parcours demande</h6>
          <button type="button" class="btn btn-dark"  (click)="d('Cross click')"> <i class="fa fa-times"></i></button>
        </div>
        <div class="modal-body">
           <table class="table">
            <thead> 
                <th>#</th>
                <th>Libellé</th>
                <th>Date et heure</th>
                <th>Séjour (jrs)</th>
                <th>Auteur</th>
            </thead>
            <tbody>
                <tr *ngFor="let p of parcours; let i=index">
                    <td>{{i+1}}</td>
                    <td>{{p.libelle}}</td>
                    <td>{{p.created_at | date:"dd-MM-yyyy hh:mm:ss"}}</td>
                    <td>{{p.delay}}</td>
                    <td>{{p.user == null ?"CAPE": p.user?.firstname??"Prénom(s)" +" "+ p.user?.lastname?? "Nom"}}</td>
                </tr>
            </tbody>
           </table>
        </div>

      </ng-template>
      